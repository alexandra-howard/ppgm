install.packages("usethis")
install.packages("devtools")
library(devtools)
library(ape)
devtools::load_all()
?ppgm
#load test data
test_path("testdata","testocc.rda")
#load test data
occ <- test_path("testdata","testocc.rda")
#load test data
occ <- load(test_path("testdata","testocc.rda"))
load(test_path("testdata","testtree.rda"))
load(test_path("testdata","testfos.rda"))
ppgm(testocc,fossils=FALSE,trees=testtree, model="BM",which.biovars=1)
t1 <- ppgm(testocc,fossils=FALSE,trees=testtree, model="BM",which.biovars=1,paleoclimateUser=testclim)
testtree <- sample(testtree,size=5)
save(testree)
save(testtree)
save(testtree,file="testtree.rda")
load(test_path("testdata","testtree.rda"))
t1 <- ppgm(testocc,fossils=FALSE,trees=testtree, model="BM",which.biovars=1,paleoclimateUser=testclim)
tBM <- ppgm(testocc,fossils=FALSE,trees=testtree, model="BM",which.biovars=1,paleoclimateUser=testclim)
tBM  <- ppgm(testocc,fossils=FALSE,trees=testtree, model="BM",which.biovars=1,paleoclimateUser=testclim)
tE   <- ppgm(testocc,fossils=FALSE,trees=testtree, model="estimate",which.biovars=1,paleoclimateUser=testclim)
tE$AICcmin
tBM
tBM$
tBM$
node_est
tBM$node_est
length(testtree)
length(tBM$node_est)
#test fossil
tfos <- ppgm(testocc,fossils=FALSE,trees=testtree,fossils=testfos,which.biovars=1,paleoclimateUser=testclim)
tfos <- ppgm(testocc,fossils=testfos,trees=testtree,which.biovars=1,paleoclimateUser=testclim)
test_that("ppgm BM works", {
#load test data
load(test_path("testdata","testocc.rda"))
load(test_path("testdata","testtree.rda"))
load(test_path("testdata","testfos.rda"))
load(test_path("testdata","testclim.rda"))
#test BM
tBM  <- ppgm(testocc,fossils=FALSE,trees=testtree,model="BM",which.biovars=1,paleoclimateUser=testclim)
#test estimate
tE   <- ppgm(testocc,fossils=FALSE,trees=testtree,model="estimate",which.biovars=1,paleoclimateUser=testclim)
#test fossil
tfos <- ppgm(testocc,fossils=FALSE,trees=testtree,fossils=testfos,which.biovars=1,paleoclimateUser=testclim)
#checking
expect_equal(length(tBM$node_est),length(testree))
})
test_that("ppgm BM works", {
#load test data
load(test_path("testdata","testocc.rda"))
load(test_path("testdata","testtree.rda"))
load(test_path("testdata","testfos.rda"))
load(test_path("testdata","testclim.rda"))
#test BM
tBM  <- ppgm(testocc,fossils=FALSE,trees=testtree,model="BM",which.biovars=1,paleoclimateUser=testclim)
#test estimate
tE   <- ppgm(testocc,fossils=FALSE,trees=testtree,model="estimate",which.biovars=1,paleoclimateUser=testclim)
#test fossil
tfos <- ppgm(testocc,trees=testtree,fossils=testfos,which.biovars=1,paleoclimateUser=testclim)
#checking
expect_equal(length(tBM$node_est),length(testree))
})
test_that("ppgm works", {
#load test data
load(test_path("testdata","testocc.rda"))
load(test_path("testdata","testtree.rda"))
load(test_path("testdata","testfos.rda"))
load(test_path("testdata","testclim.rda"))
#test BM
tBM  <- ppgm(testocc,fossils=FALSE,trees=testtree,model="BM",which.biovars=1,paleoclimateUser=testclim)
#test estimate
tE   <- ppgm(testocc,fossils=FALSE,trees=testtree,model="estimate",which.biovars=1,paleoclimateUser=testclim)
#test fossil
tfos <- ppgm(testocc,trees=testtree,fossils=testfos,which.biovars=1,paleoclimateUser=testclim)
#checking
expect_equal(length(tBM$node_est),length(testtree))
})
tE$node_est
length(tE$node_est)
length(tfos$node_est)
?expect_length
#checking outputs
expect_length(tBM$node_est,testtree)
??stringi
devtools::load_all()
usethis::use_test(ppgm)
usethis::use_test("ppgm")
#load test data
load(test_path("testdata","testocc.rda"))
load(test_path("testdata","testtree.rda"))
load(test_path("testdata","testfos.rda"))
load(test_path("testdata","testclim.rda"))
#test BM
tBM  <- ppgm(testocc,fossils=FALSE,trees=testtree,model="BM",which.biovars=1,paleoclimateUser=testclim)
#test estimate
tE   <- ppgm(testocc,fossils=FALSE,trees=testtree,model="estimate",which.biovars=1,paleoclimateUser=testclim)
#test fossil
tfos <- ppgm(testocc,trees=testtree,fossils=testfos,which.biovars=1,paleoclimateUser=testclim)
View(testfos)
testfos <- cbind("0.8","1.3",testfos[,3:4])
testfos <- cbind("0.8","1.3",testfos[,c(3:4)])
testfos <- c("0.8","1.3",testfos[,c(3:4)])
testfos[3]
testfos <- c("0.8","1.3",testfos[2:3])
testfos <- as.numeric(tesfos)
testfos <- as.numeric(testfos)
save(testfos,file="testfos.rda")
load(test_path("testdata","testfos.rda"))
#test fossil
tfos <- ppgm(testocc,trees=testtree,fossils=testfos,which.biovars=1,paleoclimateUser=testclim)
testfos <- as.matrix(testfos)
save(testfos,file="testfos.rda")
load(test_path("testdata","testfos.rda"))
#test fossil
tfos <- ppgm(testocc,trees=testtree,fossils=testfos,which.biovars=1,paleoclimateUser=testclim)
View(testfos)
testfos <- t(testfos)
View(testfos)
colnames(testfos) <- c("Min","Max","Long","Lat")
save(testfos,file="testfos.rda")
load(test_path("testdata","testfos.rda"))
#test fossil
tfos <- ppgm(testocc,trees=testtree,fossils=testfos,which.biovars=1,paleoclimateUser=testclim)
#checking outputs
expect_equal(length(tBM$node_est),length(testtree))
expect_equal(length(tE$node_est),length(testtree))
expect_equal(length(tfos$node_est),length(testtree))
devtools::test()
data("scel_fossils")
View(scel_fossils)
View(scel_fossils)
load("C:/Users/Alex/Documents/GitHub/ppgm/Rivera2020/fossils.RData")
scel_fossils <- fossils[,3:6]
scel_fossils <- fossils[,c(4,3,5,6)]
colnames(scel_fossils) <- c("MinAge","MaxAge","Longitude","Latitude")
scel_fossils <- as.matrix(scel_fossils)
save(secl_fossils, file="scel_fossils.rda")
save(scel_fossils, file="scel_fossils.rda")
devtools::test()
usethis::use_test("ppgmConsensus")
devtools::check()
devtools::document()
devtools::check()
data(sampletrees)
data(occurrences)
bounds <- list(sigsq = c(min = 0, max = 1000000))
sample <-sample(sampletrees,5)
test_ppgm <- ppgm(occurrences = occurrences,trees = sample,
model = "BM", which.biovars = c(1), bounds = bounds,
control = list(niter = 20))
plotTraitGramMultiPhylo(test_ppgm$treedata_min,test_ppgm$treedata_max,test_ppgm$node_est)
data(sampletrees)
data(occurrences)
data(scel_fossils)
#set bounds for analysis
bounds <- list(sigsq = c(min = 0, max = 1000000))
ex_mytree <- sampletrees[[3]] #single tree
data(sampletrees)
data(occurrences)
bounds <- list(sigsq = c(min = 0, max = 1000000))
ex_mytree <- sampletrees[[3]] #single tree
test_con <- ppgmConsensus(occurrences = occurrences, trees = ex_mytree,
which.biovars = 1, bounds = bounds, control = list(niter = 20))
plotTraitGram(test_con$treedata_min,test_con$treedata_max,test_con$node_est)
rm(list=ls())
#load test data
load(test_path("testdata","testocc.rda"))
load(test_path("testdata","testtree.rda"))
load(test_path("testdata","testfos.rda"))
load(test_path("testdata","testclim.rda"))
testtree <- testtree[[1]]
#test BM
tBM  <- ppgmConsensus(testocc ,fossils=FALSE, trees=testtree, model="BM", which.biovars=1, paleoclimateUser=testclim)
#test estimate
tE   <- ppgmConsensus(testocc, fossils=FALSE, trees=testtree, model="estimate", which.biovars=1, paleoclimateUser=testclim)
#test fossil
tfos <- ppgmConsensus(testocc, trees=testtree, fossils=testfos, which.biovars=1, paleoclimateUser=testclim)
tBM$node_est
length(tBM$node_est[[1]])
devtools::check()
